<a class="btn btn-default btn-bg pull-right" href='<%= url "/nodes?q=role:#{role.name}" %>'>Nodes</a>

<div class="page-header">
  <h1><%= role.name %></h1>
</div>

<%== role.description.empty? ? '' : "<p>#{role.description}</p>" %>

<% if role.run_list.empty? == false && role.env_run_lists.empty? -%>
<h2>Run List</h2>
<ul class="list-unstyled">
<%     role.run_list.each do |run_list| -%>
  <li><%  if run_list["role"] != nil -%>
    <a href='<%= url "/role/#{run_list.gsub('role[', '').gsub(']', '')}" %>'><%= run_list %></a>
<%        else -%>
<%=         run_list %>
<%        end -%>
  </li>
<%     end -%>
</ul>
<% end -%>
<% if role.run_list.empty? == false && role.env_run_lists.empty? == false -%>
<h2>Run List</h2>
<div class="tabbable">
  <ul class="nav nav-tabs">
    <li class="active"><a href="#default" data-toggle="tab">Default</a></li>
<%   role.env_run_lists.keys.each do |env| -%>
    <li><a href="#<%= env %>" data-toggle="tab"><%= env %></a></li>
<%   end -%>
  </ul>
  <div class="tab-content">
    <div class="tab-pane active" id="default">
      <ul class="list-unstyled">
<%     role.run_list.each do |run_list| -%>
        <li><%  if run_list["role"] != nil -%>
            <a href='<%= url "/role/#{run_list.gsub('role[', '').gsub(']', '')}" %>'><%= run_list %></a>
            <%  else -%>
            <%=   run_list %>
            <%  end %>
        </li>
<%     end -%>
      </ul>
    </div>
<%   role.env_run_lists.each do |env, run_list| -%>
    <div class="tab-pane fade in" id="<%= env %>">
      <ul class="list-unstyled">
<%     run_list.each do |run| -%>
        <li><%= run %></li>
<%     end -%>
      </ul>
    </div>
<%   end -%>
  </div>
</div>
<% end -%>

<% if tabs["default"].empty? == false && tabs["override"].empty? == false -%>
<h2>Attributes</h2>
<div class="tabbable">
  <ul class="nav nav-tabs">
<% tabs.each do |tab_name, tab_data| -%>
    <li<%== tab_name == active_tab ? ' class="active"' : '' %>><a href="#attributes-<%= tab_name %>" data-toggle="tab"><%= tab_name.capitalize %></a></li>
<% end -%>
  </ul>
  <div class="tab-content">
<%   tabs.each do |tab_name, tab_data| -%>
    <div class="tab-pane <%= tab_name == active_tab ? 'active' : 'fade in'  %>" id="attributes-<%= tab_name %>">
      <div class="filterable">
        <table class="table table-condensed table-striped table-hover">
<%     with_jsonpath(tab_data) do |path, value| -%>
          <tr><td><%= path %></td><td><%== pretty_value(value) %></td></tr>
<%     end -%>
        </table>
      </div>
    </div>
<%   end -%>
  </div>
</div>
<% elsif tabs["default"].empty? == false || tabs["override"].empty == false -%>
<h2>Attributes</h2>
      <div class="filterable">
        <table class="table table-condensed table-striped table-hover">
<%     with_jsonpath(tabs.values) do |path, value| -%>
          <tr><td><%= path %></td><td><%== pretty_value(value) %></td></tr>
<%     end -%>
        </table>
      </div>
<% end -%>
